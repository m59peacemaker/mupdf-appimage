name: update
on:
  push:
    branches:
      - master
  schedule:
    - cron: "* */2 * * *"
env:
  SOURCE: ArtifexSoftware/mupdf
  SOURCE_DIR: ${{ github.workspace }}/mupdf
jobs:
  update:
    runs-on: "ubuntu-20.04"
    steps:
      - run: apt-get update -qq && apt-get -qq -y install xorg-dev mesa-common-dev libgl1-mesa-dev libxcursor-dev libxrandr-dev libxinerama-dev libgtk2.0-dev
      - uses: actions/checkout@v2
        with:
          repository: ${{ github.repository }}
          path: project-root
          fetch-depth: 0
      - uses: actions/checkout@v2
        with:
          repository: ${{ env.SOURCE }}
          path: mupdf
          fetch-depth: 0
          submodules: true
      - uses: actions/setup-node@v1
        with:
          node-version: ${{ matrix.node-version }}
      - working-directory: project-root/ci
        run: npm install
      - working-directory: project-root
        run: ci/scripts/update.js "ArtifexSoftware/mupdf"
